{% extends "layout.html" %}
{% block content %}
<h2>Playlist: {{ playlist.title }}</h2>

{% if songs|length > 0 %}
<table class="table table-striped">
  <thead>
    <tr>
      <th>Title</th>
      <th>Artist</th>
      <th>Album</th>
      <th>Duration</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for song in songs %}
    <tr>
      <td>{{song.title}}</td>
      <td>{{song.artist}}</td>
      <td>{{song.album}}</td>
      <td>{{ format_duration(song.duration) }}</td>
      <td>
        <a class="btn-sm btn-primary" href="{{ song.external_url }}"><span class="glyphicon glyphicon-play"></span></a>
        <a onclick="removeSongFromPlaylist({{song.id}}, {{playlist.id}})" class="btn-sm btn-primary" ><span class="glyphicon glyphicon-remove-circle"></span>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
<script>
function removeSongFromPlaylist(songId, playlistId) {
  $.ajax({
    type: "POST",
    url: "{{ url_for('playlist_remove') }}",
    data: JSON.stringify({
      song_id: songId,
      playlist_id: playlistId
    }),
    contentType: "application/json",
    dataType: 'json',
    success: function() {
      window.location = "{{url_for('playlist', playlist_id="")}}" + playlistId;
    }
  });
}
</script>
{% else %}
<p>This playlist has no songs. Use the search bar above to search for songs to add!</p>
{% endif %}

{% endblock %}
